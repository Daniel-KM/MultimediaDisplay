<?php
/**
 * Multimedia Display Kaltura Viewer
 * 
 * @copyright Copyright 2014 UCSC Library Digital Initiatives
 * @license http://www.gnu.org/licenses/gpl-3.0.txt GNU GPLv3
 * @package MultimediaDisplay
 */

/**
 * Multimedia Display Kaltura Viewer class
 * 
 */
class Mmd_Kaltura_Viewer extends Mmd_Abstract_Viewer
{


     /**
     * Install default profile
     *
     * Install default item types, elements, and profiles for easy setup
     *
     * @return void
     */
    public static function InstallDefaults() {
        $itemType = new ItemType();
        $itemType->save();

        $element = new Element();
        $element->save();

        $profile = new Mmd???();
        $profile->name = '';
        $profile->viewer = '';
        $profile->save();
    }

    /**
     * Revert to default profile
     *
     * Re-install default item types, elements, and profiles
     *
     * @return void
     */
    public static function RevertDefaults() {
        $defaultProfile = get_db()->getTable('Mmd???')->findBy(array('name'=>''));
        $defaultProfile->delete();
        self::InstallDefaults();
    }

    /**
     * Retrieve viewer parameters
     *
     * @return array All parameters supported to customize the viewer display
     */
    public static function GetParameters() {
        $params = array(
            array(
                'name'=>'',
                'type'=>'',
                'value'=>array('','',''),
                'required'=>false,
                'default'=>''
            ),
            array(
                'name'=>'',
                'type'=>'',
                'value'=>array('','',''),
                'required'=>false,
                'default'=>''
            )
        );
        
        return $params;
    }


    /**
     * Queue header scripts
     *
     * Queues script libraries and stylesheets to include in header
     *
     * @return null
     */
    public function head() {

        ob_start();
?>
?<php
        return ob_get_clean();

    }


    /**
     * Retrieve body html
     *
     * Retrieves markup to include in the main content body of item show pages
     *
     * @return string Html to include in the header, 
     * linking to stylesheets and javascript libraries
     */
    public function getBodyHtml() {
      
        ob_start();
?>
<?php
        return ob_get_clean();
    }

/*
    public function display() {
        $params = $_this->viewer_options;
        $params = array_merge($params,$_this->item_options);
        ob_start();
        ?>
        <script type="text/javascript" src="http://www.kaltura.com/p/475671/sp/47567100/embedIframeJs/uiconf_id/<?php echo $uiConfID;?>/partner_id/475671"></script>

        <object 
          id="kaltura_player_1337299051" 
          name="kaltura_player_1337299051" 
          type="application/x-shockwave-flash" 
          allowFullScreen="true" 
          allowNetworking="all" 
          allowScriptAccess="always" 
          height="<?php echo $params['height'];?>" 
          width="<?php echo $params['width'];?>" 
          bgcolor="#FFFFFF" 
          xmlns:dc="http://purl.org/dc/terms/" 
          xmlns:media="http://search.yahoo.com/searchmonkey/media/" 
          rel="media:video" 
          resource="http://www.kaltura.com/index.php/kwidget/cache_st/1337299051/wid/_475671/uiconf_id/<?php echo $params['uiConfID'];?>/entry_id/<?php echo $params['entryID'];?>" 
          data="http://www.kaltura.com/index.php/kwidget/cache_st/1337299051/wid/_475671/uiconf_id/<?php echo $params['uiConfID'];?> . '/entry_id/<?php echo $params['entryID'];?>"
        >
              <param name="allowFullScreen" value="true" />
              <param name="allowNetworking" value="all" />
              <param name="allowScriptAccess" value="always" />
              <param name="bgcolor" value="#000000" /> 
              <param name="flashVars" value="&{FLAVOR}" />
              <span property="media:width" content="<?php $params['width'];?>"></span>
              <span property="media:height" content="<?php $params['height'];?>"></span>
              <span property="media:type" content="application/x-shockwave-flash"></span>
        </object>

        <?php

        return ob_get_clean();
    }

*/
}

?>