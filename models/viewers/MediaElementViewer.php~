<?php
/**
 * Multimedia Display MediaElement Viewer
 * 
 * @copyright Copyright 2014 UCSC Library Digital Initiatives
 * @license http://www.gnu.org/licenses/gpl-3.0.txt GNU GPLv3
 * @package MultimediaDisplay
 */

/**
 * Multimedia Display MediaElement Viewer class
 * 
 */
class Mmd_MediaElement_Viewer extends Mmd_Abstract_Viewer
{

    
     /**
     * Install default profile
     *
     * Install default item types, elements, and profiles for easy setup
     *
     * @return void
     */
    public static function InstallDefaults() {
        $itemType = new ItemType();
        $itemType->save();

        $element = new Element();
        $element->save();

        $profile = new Mmd???();
        $profile->name = '';
        $profile->viewer = '';
        $profile->save();
    }

    /**
     * Revert to default profile
     *
     * Re-install default item types, elements, and profiles
     *
     * @return void
     */
    public static function RevertDefaults() {
        $defaultProfile = get_db()->getTable('Mmd???')->findBy(array('name'=>''));
        $defaultProfile->delete();
        self::InstallDefaults();
    }

    /**
     * Retrieve viewer parameters
     *
     * @return array All parameters supported to customize the viewer display
     */
    public static function GetParameters() {
        $params = array(
            array(
                'name'=>'',
                'type'=>'',
                'value'=>array('','',''),
                'required'=>false,
                'default'=>''
            ),
            array(
                'name'=>'',
                'type'=>'',
                'value'=>array('','',''),
                'required'=>false,
                'default'=>''
            )
        );
        
        return $params;
    }

    /**
     * Retrieve head html
     *
     * Retrieves html tags to include in the page header
     *
     * @return string Html to include in the header, 
     * linking to stylesheets and javascript libraries
     */
    public function getHeadHtml() {

        ob_start();
?>
?<php
        return ob_get_clean();

    }


    /**
     * Retrieve body html
     *
     * Retrieves markup to include in the main content body of item show pages
     *
     * @return string Html to include in the header, 
     * linking to stylesheets and javascript libraries
     */
    public function getBodyHtml() {
      
        ob_start();
?>
<?php
        return ob_get_clean();
    }

    /**
     * Retrieve foot html
     *
     * Retrieves markup to include after the main content body 
     * of item show pages, to trigger js loading
     *
     * @return string Html to include in the header, 
     * linking to stylesheets and javascript libraries
     */
    public function getFootHtml() {

    }
        
  



    public function display() {
        $jsDir = dirname(dirname(dirname(__FILE__))).
                     '/libraries/mediaelement/build/';
        $cssDir = dirname(dirname(dirname(__FILE__))).
                     '/libraries/mediaelement/build/';

        ob_start();

        ?>
        <script src="<?php echo $jsDir; ?>mediaelement-and-player.min.js"></script>
        <link rel="stylesheet" href="<?php echo $cssDir; ?>mediaelementplayer.css" />

        <video width="320" height="240" poster="poster.jpg" controls="controls" preload="none">
           <!-- MP4 for Safari, IE9, iPhone, iPad, Android, and Windows Phone 7 -->
           <source type="video/mp4" src="myvideo.mp4" />
           <!-- WebM/VP8 for Firefox4, Opera, and Chrome -->
           <source type="video/webm" src="myvideo.webm" />
           <!-- Ogg/Vorbis for older Firefox and Opera versions -->
           <source type="video/ogg" src="myvideo.ogv" />
<?php /*
           <!-- Optional: Add subtitles for each language -->
           <track kind="subtitles" src="subtitles.srt" srclang="en" />
           <!-- Optional: Add chapters -->
           <track kind="chapters" src="chapters.srt" srclang="en" />

      */?>
        
           <!-- Flash fallback for non-HTML5 browsers without JavaScript -->
           <object width="320" height="240" type="application/x-shockwave-flash" data="flashmediaelement.swf">
              <param name="movie" value="flashmediaelement.swf" />
              <param name="flashvars" value="controls=true&file=myvideo.mp4" />
              <!-- Image as a last resort -->
              <img src="myvideo.jpg" width="320" height="240" title="No video playback capabilities" />
           </object>
        </video>
        <script>
           jQuery('video,audio').mediaelementplayer(/* Options */);
        </script>
<?php
       return ob_get_clean();

    }
}

?>